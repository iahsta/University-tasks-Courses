---
title: "Лабораторная работа. Дисперсионный анализ"
author: "Dibirova Aishat"
date: "15 06 2020"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
---
# Дисперсионный анализ производительности труда работников в зависимости от образования и заработной платы

Для начала обозначим уровни образования переменными: 1 - среднее образование, 2 - среднее профессиональное, 3 - высшее неоконченное, 4 - высшее.
Найдем среднее по каждому уровню:
```{r}
setwd('/Users/bydag/Desktop/R')
library(readxl)
data = read_excel('данные для анализа по з.п. и образованию.xlsx')
data
meanEd = tapply(data$`Labour productivity`, data$Education, mean)
meanEd
```
Далее найдем средние значения производительности труда работников для уровней фактора заработных плат: 
```{r}
meanEx = tapply(data$`Labour productivity`, data$Salary, mean)
meanEx
```
Построим графики, которые отображают зависимость производительности труда от образования и заработной платы. Так, по первому графику видим, что труд людей с высшим и высшим неоконченным намного более производителен, чем труд людей с более низким уровнем образования.

```{r, fig.cap="*Рис. 1. Точечный график зависимости производительности труда от уровня образования, построен с помощью встроенной функции `stripchart`*"}
stripchart(`Labour productivity` ~ Education, data=data, col='magenta', ylab='Education',
xlab='Labour productivity', main='Education')
```
Второй график, представленный ниже, показывает слабую зависимость эффективности работников от уровня зарабоной платы.

```{r, fig.cap="*Рис. 2. Точечный график зависимости производительности труда от уровня з/п, построен с помощью встроенной функции `stripchart`*"}
stripchart(`Labour productivity` ~ Salary, data=data, col='blue', ylab='Salary',
xlab='Labour productivity', main='Salary')
```
Также рассмотрим графики, изображающие значения средних производительности трудо по уровню образования. Видим, что при возрастании уровня образования, эффективность труда работника растет.

```{r, fig.cap= "*Рис.3 Точечный график зависимости средней производительности труда от уровня образования (построен с помощью встроенной функции plot)*"}
plot(meanEd, type='o', col='magenta', xlab='Education', ylab='Labour productivity')
```
Возрастание зарплаты также коррелирует с ростом производительности труда, что мы можем заметить на следующем графике:
```{r, fig.cap= "*Рис.4 Точечный график зависимости средней производительности труда от уровня з/п (построен с помощью встроенной функции plot)*"}
plot(meanEd, type='o', col='magenta', xlab='Salary', ylab='Labour productivity')
```
К тому же, построим "ящик с усами". Согласно представленной ниже диаграмме, по мере увеличения уровня образования производительность туда растет. Диаграмма также показывает, что размах данных у людей с высшим и высшим неоконченным меньше, чем у людей с более низкими показателями образования. Помимо этого, наблюдается сильная асимметрия данных у людей с самым низким уровнем образованияи самым высоким.

```{r, fig.cap= "*Рис. 5. Ящичковая диаграмма (box plot) производительности труда в зависимости от уровня образования*"}
boxplot(`Labour productivity` ~ Education, data=data, ylab='Labour productivity', col='magenta')
```
Вторую ящичковую диаграмму построим, чтобы показать зависимость производительности труда от заработной платы. Видим положительную зависимость - то есть с ростом з/п растет и производительность труда. Также отметим, что размах данных у всех уровней заработных плат почти не различается, а сами данные в каждом уровне фактора довольно симметричны (в сравнении с предыдущим графиком).
```{r, fig.cap= "*Рис. 6. Ящичковая диаграмма (box plot) производительности труда в зависимости от уровня з/п*"}
boxplot(`Labour productivity` ~ Salary, data=data, ylab='Labour productivity', col='blue')
```
Далее обратимся к "скрипичным диаграммам", которые дают результаты, аналогичные ящичковым диаграммам.
```{r, fig.cap= "*Рис.7 Скрипичная диаграмма (violin plot) производительности труда в зависимости от уровня образования*"}
library('ggplot2')
data$Education <- as.factor(data$Education)
p <- ggplot(data, aes(x = Education, y = `Labour productivity`, fill = 'magenta')) + geom_violin(trim = FALSE)
p
p + coord_flip()
p + geom_boxplot(width = 0.2)
p + geom_dotplot(binaxis ='y', stackdir='center', dotsize=1)

```

## Однофакторный дисперсионный анализ
Проверим, соответствует ли распределение производительности труда работников нормальному распределению Из представленного ниже графика можем заметить, что точки наблюдаемых значений в основном сосрдоточены на прямой равенства эмпирических и теоретических моментов. Исходя из этого, можем предположить, что производительность труда подчиняется нормальному закону распределения.
```{r, fig.cap= "*Рис.9 График квантиль-квантиль производительности труда и нормального распределения (построен с помощью функции qqPlot пакета car)*"}
library('car')
qqPlot(data$`Labour productivity`)
```
Проверим гипотезу о соответствии производительности труда с помощью теста Шапиро-Уилка. Как видим, $p-value=0,2393$, что намного больше заданного для нашей задачи уровня значимости $\alpha=0,001$. Из этого следует, что нулевая гипотеза не отвергается, и мы можем заключить, что производительность труда подчиняется нормальному закону распределения.
```{r}
shapiro.test(data$`Labour productivity`)
```
Проверим гипотезу об однородности дисперсий между группами факторов образования и заработных плат. В обоих случаях $p-value$ превышает заданный уровень значимости $\alpha=0,05$, из чего следует, что гипотеза не отвергается на этом уровне.
```{r}
str(data$Education)
str(data$Salary)
data$Education <- factor(data$Education)
str(data$Education)
data$Education <- factor(data$Education)
str(data$Education)
data$Salary <- factor(data$Salary)
str(data$Salary)
leveneTest(data$`Labour productivity`, data$Education)
leveneTest(data$`Labour productivity`, data$Salary)
```
Подтвердив гипотезы о нормальном распределении и однородности дисперсий между уровнями факторов, переходим к дисперсионному анализу. Для начала проверим гипотезу о том, что уровень образования не влияет на производительность труда. Поскольку $p-value=0,000641$ намного меньше заданного уровня значмости $\alpha=0,001$, мы отвергаем нулевую гипотезу, из чего следует, что фактор образования влияет на производительность труда.
```{r}
summary(aov(data$`Labour productivity` ~ data$Education))
```
Проверим то же и для заработной платы. Поскольку $p-value=0,604$ превышает заданный уровень значимости $\alpha=0,01$, мы не отвергаем гипотезу о невлиянии фактора заработных плат на производительность труда.
```{r}
summary(aov(data$`Labour productivity` ~ data$Salary))
```
## Двухфакторный дисперсионный анализ
Проведем также двухфакторный анализ производительности труда.Полученный $p-value$ для фактора образования намного меньше заданного уровня значимости $\alpha=0,001$, из чего можем заключить, что уровень образования существенно влияет на производительность труда. Что касается уровня заработных плат, то полученный $p-value$, меньший, чем $\alpha=0,01$, свидетельствует о влиянии уровня з/п на производительность труда.

```{r}
summary(aov(data$`Labour productivity` ~ data$Education + data$Salary))
```
Проведем тест Тьюки для сравнения средней производительности труда между разными уровнями образования. Гипотеза о равенстве средних отвергается для групп 3-1, 4-1, 4-2 (поскольку они не содержат 0 в интервале, а $p-value$ намного меньше заданного уровня значимости), для остальных групп не отвергается. То есть существуют значимые различия между средними уровней высшего и среднего образования, высшего и среднего профессионального, высшего неоконченного и среднего.
Представленный график подтверждает полученные результаты - как видим, 0 действительно не попадает в три обозначенные выше интервала.
```{r, fig.cap= "*Рис.10 Доверительные интервалы для средних выборных уровней образования*"}
anova_data <- aov(data$`Labour productivity` ~ data$Education)
summary(anova_data)
TukeyHSD(anova_data)
tukey <- TukeyHSD(anova_data)
plot(tukey)
```




































